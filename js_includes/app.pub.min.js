// -----------------------------------------------------------------------------
// Toplines
// ----------------------------------

var KEYCODE_ESC = 27;
$(document).keyup(function (e) {
    if (e.which == KEYCODE_ESC) {
        $('#loader-submit').stop()
    }
});

// ----------------------------------
// Alerts - Auto Dismiss
// ----------------------------------

// Stacked Alerts - 15 seconds
setTimeout(function() {
  
  $('.alert-stacked')
  .css('opacity', 1)
  .slideUp('fast')
  .animate({ opacity: 0 },{ queue: false, duration: 'fast' })
  .removeClass('show')
  ;
  
}, 15000);

// Single Alert - 10 seconds
setTimeout(function() {

  $('#alert-auto-dismiss').fadeOut('fast');
  $('#alert-auto-dismiss').removeClass('show');
  
}, 10000);

// -----------------------------------------------------------------------------
// Functions
// ----------------------------------

// From bcoem_custom.min.js

$(function () {
    $('[data-toggle="tooltip"]').tooltip()
});

$(function () {
    $('[data-tooltip="true"]').tooltip()
});

$(function () {
    $('[data-toggle="popover"]').popover()
});

function jumpMenu(targ, selObj, restore) {
    eval(targ + ".location='" + selObj.options[selObj.selectedIndex].value + "'"),
    restore && (selObj.selectedIndex = 0)
}

function checkAvailability() {
    jQuery.ajax({
        url: username_url,
        data: 'user_name=' + $("#user_name").val(),
        type: "POST",
        success: function (data) {
            $("#username-status").html(data)
        },
        error: function () {}
    })
}

function AjaxFunction(t) {
    var e;
    try {
        e = new XMLHttpRequest()
    } catch (t) {
        try {
            e = new ActiveXObject("Msxml2.XMLHTTP")
        } catch (t) {
            try {
                e = new ActiveXObject("Microsoft.XMLHTTP")
            } catch (t) {
                return !1
            }
        }
    }
    var a = email_url;
    a = (a = a + "?email=" + t) + "&sid=" + Math.random(),
    e.onreadystatechange = function () {
        4 == e.readyState && (document.getElementById("msg_email").innerHTML = e.responseText)
    },
    e.open("GET", a, !0),
    e.send(null)
}

function EmailAjaxFunction(email) {
    var httpxml;
    try {
        httpxml = new XMLHttpRequest()
    } catch (e) {
        try {
            httpxml = new ActiveXObject("Msxml2.XMLHTTP")
        } catch (e) {
            try {
                httpxml = new ActiveXObject("Microsoft.XMLHTTP")
            } catch (e) {
                return false
            }
        }
    }
    function stateck() {
        if (httpxml.readyState == 4) {
            document
                .getElementById("msg_email")
                .innerHTML = httpxml.responseText
        }
    }
    if (setup == 1) {
        email_url = email_url + "?section=setup&email=" + email
    } else {
        email_url = email_url + "?email=" + email
    }
    email_url = email_url + "&sid=" + Math.random();
    httpxml.onreadystatechange = stateck;
    httpxml.open("GET", email_url, true);
    httpxml.send(null)
}

function formatTimeDisplay(seconds, display) {
    if (display == "") {
        var disp = 0;
    } else {
        var disp = display
    }
    var numseconds = parseInt((((seconds % 31536000) % 86400) % 3600) % 60, 10);
    if (disp == 0) {
        var numhours = parseInt(Math.floor(((seconds % 31536000) % 86400) / 3600), 10);
        var numminutes = parseInt(Math.floor((((seconds % 31536000) % 86400) % 3600) / 60), 10);
        var timer = ((numhours < 10)
            ? "0" + numhours
            : numhours) + ":" + ((numminutes < 10)
            ? "0" + numminutes
            : numminutes) + ":" + ((numseconds < 10)
            ? "0" + numseconds
            : numseconds)
    }
    if (disp == 1) {
        var numminutes = parseInt(Math.floor((((seconds % 31536000) % 86400) % 3600) / 60), 10);
        var timer = ((numminutes < 10)
            ? "0" + numminutes
            : numminutes) + ":" + ((numseconds < 10)
            ? "0" + numseconds
            : numseconds)
    }
    if (disp == 2) {
        var timer = ((numseconds < 10)
            ? "0" + numseconds
            : numseconds)
    }
    return timer
}

// Add/Edit Entry
function disp_special_ing(style, style_set) {
    if ((style_set == "BJCP2021") && (style == "2-A")) {
        $("#req-special").hide();
        $("#regionalVariation").show("fast");
        $("#specialInfo").hide("fast");
        $("#special").hide("fast");
        $("#brewInfo").val("");
        $("#darkLightColor").hide("fast");
        $("#sweetnessLambic").hide("fast");
        $("#carbLambic").hide("fast");
        $("#special").hide("fast");
        $("#strengthIPA").hide("fast");
        $("#strengthSaison").hide("fast");
        $("#BDGColor").hide("fast")
    } else {
        $("#req-special").show("fast")
    }
    if ((style_set == "BJCP2015") || (style_set == "BJCP2021")) {
        if ((style == "7-C") || (style == "9-A") || (style == "10-C")) {
            $("#brewInfo").val("");
            $("#darkLightColor").show("fast");
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#special").hide("fast");
            $("#strengthIPA").hide("fast");
            $("#strengthSaison").hide("fast");
            $("#BDGColor").hide("fast")
        } else if (style == "21-B") {
            $("#strengthIPA").show("fast");
            $("#special").show("fast");
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#darkLightColor").hide("fast");
            $("#strengthSaison").hide("fast");
            $("#BDGColor").hide("fast")
        } else if ((style == "21-B1") || (style == "21-B2") || (style == "21-B3") || (style == "21-B4") || (style == "21-B5") || (style == "21-B6") || (style == "21-B7")) {
            $("#brewInfo").val("");
            $("#strengthIPA").show("fast");
            $("#special").hide("fast");
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#darkLightColor").hide("fast");
            $("#strengthSaison").hide("fast");
            $("#BDGColor").hide("fast")
        } else if (style == "23-F") {
            $("#sweetnessLambic").show("fast");
            $("#carbLambic").show("fast");
            $("#special").show("fast");
            $("#darkLightColor").hide("fast");
            $("#strengthIPA").hide("fast");
            $("#strengthSaison").hide("fast");
            $("#BDGColor").hide("fast")
        } else if (style == "24-C") {
            $("#brewInfo").val("");
            $("#BDGColor").show("fast");
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#special").hide("fast");
            $("#darkLightColor").hide("fast");
            $("#strengthIPA").hide("fast");
            $("#strengthSaison").hide("fast")
        } else if (style == "25-B") {
            $("#brewInfo").val("");
            $("#darkLightColor").show("fast");
            $("#strengthSaison").show("fast");
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#special").hide("fast");
            $("#strengthIPA").hide("fast");
            $("#BDGColor").hide("fast")
        } else {
            if (style != "2-A") {
                $("#special").show("fast")
            }
            $("#sweetnessLambic").hide("fast");
            $("#carbLambic").hide("fast");
            $("#darkLightColor").hide("fast");
            $("#strengthIPA").hide("fast");
            $("#strengthSaison").hide("fast");
            $("#BDGColor").hide("fast")
        }
    } else {
        if (style != "2-A") {
            $("#special").show("fast")
        }
    }
}

function disp_strength(style, style_set) {
    $("#strength").show("fast");
    $("#req-strength").show("fast")
}

function disp_sweetness(style, style_set) {
    if ((style.startsWith("C")) || ($.inArray(style, cider_sweetness_custom_styles) > -1)) {
        $("#sweetness-cider").show("fast")
    }
    if ((style.startsWith("M")) || ($.inArray(style, mead_sweetness_custom_styles) > -1)) {
        $("#sweetness-mead").show("fast")
    }
    $("#req-sweetness").show("fast")
}

function disp_carbonation(style, style_set) {
    $("#carbonation").show("fast");
    $("#req-carbonation").show("fast")
}

function disp_optional(style, style_set) {
    $("#optional").show("fast")
}

function reset_element_states(edit_style) {
    $("#regionalVariation").removeClass("has-error");
    $("#BDGColor").removeClass("has-error");
    $("#strengthIPA").removeClass("has-error");
    $("#sweetnessLambic").removeClass("has-error");
    $("#carbLambic").removeClass("has-error");
    $("#darkLightColor").removeClass("has-error");
    $("#strengthSaison").removeClass("has-error");
    $("#special").removeClass("has-error");
    $("#fg-carbonation").removeClass("has-error");
    $("#fg-sweetness").removeClass("has-error");
    $("#fg-strength").removeClass("has-error");
    $("#possible-allergens").removeClass("has-error");
    $("#brewInfo").prop("required", false);
    $("#brewInfoOptional").prop("required", false);
    $("input[name='regionalVar']").prop("required", false);
    $("input[name='strengthIPA']").prop("required", false);
    $("input[name='sweetnessLambic']").prop("required", false);
    $("input[name='carbLambic']").prop("required", false);
    $("input[name='darkLightColor']").prop("required", false);
    $("input[name='strengthSaison']").prop("required", false);
    $("input[name='BDGColor']").prop("required", false);
    $("#sweetnessLambic").hide("fast");
    $("#carbLambic").hide("fast");
    $("#special").hide("fast");
    $("#optional").hide("fast");
    $("#darkLightColor").hide("fast");
    $("#strengthIPA").hide("fast");
    $("#strengthSaison").hide("fast");
    $("#BDGColor").hide("fast");
    $("#carbonation").hide("fast");
    $("#sweetness-mead").hide("fast");
    $("#sweetness-cider").hide("fast");
    $("#strength").hide("fast");
    $("#req-special").hide("fast");
    $("#req-carbonation").hide("fast");
    $("#req-sweetness").hide("fast");
    $("#req-strength").hide("fast");
    $("#specialInfo").hide("fast");
    $("#possible-allergens").hide("fast");
    $("#regionalVariation").hide("fast");
    if (edit_style == "default") {
        if (user_level > 1) {
            $("#brewInfo").val("");
            $("#brewInfoOptional").val("");
            $("#brewComments").val("");
            $("#regionalVar").val("");
            $("input[name='brewPossAllergens']").prop("required", false);
            $("input[name='brewPossAllergens']").val("");
            $("input[name='strengthIPA']").removeAttr("checked");
            $("input[name='sweetnessLambic']").removeAttr("checked");
            $("input[name='carbLambic']").removeAttr("checked");
            $("input[name='darkLightColor']").removeAttr("checked");
            $("input[name='strengthSaison']").removeAttr("checked");
            $("input[name='BDGColor']").removeAttr("checked");
            $("input[name='brewMead1']").removeAttr("checked");
            $("input[name='brewMead2-mead']").removeAttr("checked");
            $("input[name='brewMead2-cider']").removeAttr("checked");
            $("input[name='brewMead3']").removeAttr("checked");
            $("input[name='possible-allergens']").removeAttr("checked");
            $("#possAllergens_1").prop("checked", true);
            $("#brewPouringInst-Normal").prop("checked", true);
            $("#brewPouringRouse-No").prop("checked", true);
            $("#brewPouringNotes").val("");
            $("#brewABV").val("");
        }
    }
}

function require_visible() {
    if ($("#special").is(":visible")) {
        $("#brewInfo").prop("required", true)
    }
    if ($("#strengthIPA").is(":visible")) {
        $("input[name='strengthIPA']").prop("required", true)
    }
    if ($("#sweetnessLambic").is(":visible")) {
        $("input[name='sweetnessLambic']").prop("required", true)
    }
    if ($("#carbLambic").is(":visible")) {
        $("input[name='carbLambic']").prop("required", true)
    }
    if ($("#darkLightColor").is(":visible")) {
        $("input[name='darkLightColor']").prop("required", true)
    }
    if ($("#strengthSaison").is(":visible")) {
        $("input[name='strengthSaison']").prop("required", true)
    }
    if ($("#BDGColor").is(":visible")) {
        $("input[name='BDGColor']").prop("required", true)
    }
    if ($("#strength").is(":visible")) {
        $("input[name='brewMead3']").prop("required", true)
    }
    if ($("#carbonation").is(":visible")) {
        $("input[name='brewMead1']").prop("required", true)
    }
    if ($("#sweetness-mead").is(":visible")) {
        $("input[name='brewMead2-mead']").prop("required", true)
    }
    if ($("#sweetness-cider").is(":visible")) {
        $("input[name='brewMead2-cider']").prop("required", true)
    }
}

function disp_req_modal(style, style_set) {
    let style_exists = style in req_special_ing_style_info;
    if (style_exists) {
        var special_modal_id = "#" + style + "-modal";
        var special_modal_link = "<a href='#' title='Select for specifics for this style.' data-toggle='modal' dat" +
                "a-target='" + special_modal_id + "'><span title='Select for specifics for this style.' data-toggle='tooltip' data-" +
                "placement='top'>" + label_this_style + "</span></a>";
        var special_info_text = req_special_ing_style_info[style];
        $("#specialInfo").show("fast");
        $("#specialInfoName").html(special_modal_link);
        $("#specialInfoText").html(special_info_text)
    }
}

// -----------------------------------------------------------------------------

$(document).ready(function () {

    // ----------------------------------
    // From bcoem_custom.js
    // ----------------------------------

    // Do certain functions on click, scroll, etc.
    $(document).on('scroll click blur change', function () {

        // Relates to registration, add/edit of 
        if ($("#form-submit-button").is(":disabled") || $("#form-submit-button").hasClass("disabled")) {
            $("#form-submit-button-disabled-msg-required").fadeIn();
        }
        else $("#form-submit-button-disabled-msg-required").fadeOut();
    
    });

    $("#submitBtn").click(function () {
        $("#archiveName").html($("#archiveSuffix").val())
    });
    
    $("#submit").click(function () {
        $("#formfield").submit()
    });
    
    $("#admin-arrow").click(function () {
        $(this)
            .find("i")
            .toggleClass("fa-chevron-circle-left fa-chevron-circle-right"),
        $(this)
            .find("i")
            .toggleClass("text-teal text-orange")
    });
    
    $(".my-dropdown").dropdown(),
    
    $(".my-dropdown").tooltip();
    
    $("a[data-confirm]").click(function (t) {
        var e = $(this).attr("href");
        return $("#dataConfirmModal").length || $("body").append('<div class="modal fade" id="dataConfirmModal" aria-labelledby="dataConfirmLabel"' +
                '><div class="modal-dialog"><div class="modal-content"><div class="modal-header">' +
                '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><spa' +
                'n aria-hidden="true">&times;</span></button><h4 id="dataConfirmLabel" class="mod' +
                'al-title">Please Confirm</h4></div><div class="modal-body"></div><div class="mod' +
                'al-footer"><button type="button" class="btn btn-danger" data-dismiss="modal">Can' +
                'cel</button><a class="btn btn-success" id="dataConfirmOK">Yes</a></div></div></d' +
                'iv></div>'),
        $("#dataConfirmModal")
            .find(".modal-body")
            .text($(this).attr("data-confirm")),
        $("#dataConfirmOK").attr("href", e),
        $("#dataConfirmModal").modal({
            show: !0
        }),
        !1
    });
    
    // ----------------------------------
    // Loader Target
    // ----------------------------------
    
    /*
    $("a").attr('target', function () {
        if (this.host == location.host) {
            if (typeof($(this).attr('data-confirm')) != 'undefined') {
                $(this).addClass("hide-loader");
                return "_self"
            }
            if ($(this).attr("id") != "modal_window_link") {
                $(this).removeClass("hide-loader");
                return "_self"
            }
        } else {
            $(this).addClass("hide-loader");
            return "_blank"
        }
    });
    */
    
    $("a:not([href*='#'],[target='_blank'])").click(function () {
        
        if (!$(this).hasClass("hide-loader")) {
            $('#loader-submit').show(0).delay(30000).hide(0);
        }

        else {
            $('#loader-submit').hide();
        }

    });

    $("form").submit(function () {
        
        if (!$(this).hasClass("hide-loader-form-submit")) {
            $('#loader-submit').show(0).delay(30000).hide(0);
        }

        else {
            $('#loader-submit').hide();
        }

    });

    $("#form-submit-button-disabled-msg-required").hide();

    $("#form-submit-button").click(function () {
        if ($(this).is(":disabled") || $(this).hasClass("disabled")) {
            $("#submit-form").removeClass("hide-loader-form-submit");
            $("#submit-form").addClass("hide-loader-form-submit");
            $("#form-submit-button-disabled-msg-required").fadeIn();
        } else {
            $("#submit-form").removeClass("hide-loader-form-submit");
            $("#form-submit-button-disabled-msg-required").fadeOut();
        }
    });

    $(".hide-loader").click(function() {
        $('#loader-submit').hide();
    });

    $(".modal-window-link").click(function() {
        $('#loader-submit').hide();
    });

    // ----------------------------------
    // Fancybox Configuration
    // https://www.cpcards.co.uk/assets/fancybox3/docs/
    // ----------------------------------
    
    $(".modal-window-link").fancybox({
        toolbar: false,
        smallBtn: true,
        buttons: [
            "close"
        ],
        iframe : {
            attr: {
                scrolling: "auto"
            },
            preload: true
        }       
    });

    
    $('[data-fancybox="gallery"]').fancybox({
      buttons: [
        "slideShow",
        "thumbs",
        "zoom",
        "fullScreen",
        "share",
        "close"
      ],
      loop: true,
      protect: true
    });

    // ----------------------------------
    // Date/Time
    // ----------------------------------
    
    $(function(){
        $('.date-time-picker-system').datetimepicker({format: 'YYYY-MM-DD hh:mm A'});
    });

    // ----------------------------------
    // Add/Edit Style
    // ----------------------------------

    if ((section == "admin") && (go == "styles")) {

        $("#mead-cider").hide("fast");
        $("#mead").hide("fast");
        $("#brewStyleEntry").hide("fast");
        $("#brewStyleEntryTextArea").prop("required", false);
        $("input[name='brewStyleCarb']").prop("required", false);
        $("input[name='brewStyleSweet']").prop("required", false);
        $("input[name='brewStyleStrength']").prop("required", false);

        if (edit_style == "edit") {
            if (req_special == 1) {
                $("#brewStyleEntry").show("fast");
                $("textarea[name='brewStyleEntry']").prop("required", true)
            }
            if (style_type == 2) {
                $("#mead-cider").show("fast");
                $("input[name='brewStyleCarb']").prop("required", true);
                $("input[name='brewStyleSweet']").prop("required", true)
            }
            if (style_type == 3) {
                $("#mead-cider").show("fast");
                $("#mead").show("fast");
                $("input[name='brewStyleCarb']").prop("required", true);
                $("input[name='brewStyleSweet']").prop("required", true);
                $("input[name='brewStyleStrength']").prop("required", true)
            }
        }

        $("#brewStyleType").change(function () {
            $("#mead-cider").hide("fast");
            $("#mead").hide("fast");
            $("input[name='brewStyleStrength']").removeAttr("checked");
            $("#brewStyleStrength_1").prop("checked", true);
            $("input[name='brewStyleSweet']").removeAttr("checked");
            $("#brewStyleSweet_1").prop("checked", true);
            $("input[name='brewStyleCarb']").removeAttr("checked");
            $("#brewStyleCarb_1").prop("checked", true);
            $("input[name='brewStyleReqSpec']").removeAttr("checked");
            $("#brewStyleReqSpec_1").prop("checked", true);
            $("#brewStyleEntry").hide("fast");
            $("#brewStyleEntryTextArea").val("");
            if ($("#brewStyleType").val() == "3") {
                $("#mead-cider").show("fast");
                $("#mead").show("fast");
                $("input[name='brewStyleCarb']").prop("required", true);
                $("input[name='brewStyleSweet']").prop("required", true);
                $("input[name='brewStyleStrength']").prop("required", true)
            } else if ($("#brewStyleType").val() == "2") {
                $("#mead").hide("fast");
                $("#mead-cider").show("fast");
                $("input[name='brewStyleCarb']").prop("required", true);
                $("input[name='brewStyleSweet']").prop("required", true)
            }
        });

        $('input[name=brewStyleReqSpec]').click(function () {
            if ($(this).attr('id') == 'brewStyleReqSpec_0') {
                $("#brewStyleEntry").show("fast");
                $("#brewStyleEntryTextArea").prop("required", true)
            } else {
                $("#brewStyleEntry").hide("fast");
                $("#brewStyleEntryTextArea").prop("required", false);
                $("#brewStyleEntryTextArea").val("")
            }
        });

    }

    // ----------------------------------
    // Add/Edit Entry
    // ----------------------------------

    if (section == "brew") {

        $("#specify-pouring").hide();

        $("#brewInfo").keyup(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countInfo').text(cs)
        });
        
        $("#brewInfo").keydown(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countInfo').text(cs)
        });
        
        $("#brewInfoOptional").keyup(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countInfoOptional').text(cs)
        });
        
        $("#brewInfoOptional").keydown(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countInfoOptional').text(cs)
        });
        
        $("#brewComments").keyup(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countComments').text(cs)
        });
        
        $("#brewComments").keydown(function () {
            var cs = $(this)
                .val()
                .length;
            $('#countComments').text(cs)
        });
        
        $("#possible-allergens").hide();
        
        $("input[name$='possible-allergens']").click(function () {
            if ($(this).val() == "1") {
                $("#possible-allergens").show("fast");
                $("input[name='brewPossAllergens']").prop("required", true)
            } else {
                $("#possible-allergens").hide("fast");
                $("input[name='brewPossAllergens']").prop("required", false);
                $("input[name='brewPossAllergens']").val("")
            }
        });
        
        reset_element_states(edit_style);
        
        if (edit_style != "default") {
            var special_ing = $.inArray(edit_style, req_special_ing_styles);
            var strength = $.inArray(edit_style, req_strength_styles);
            var sweetness = $.inArray(edit_style, req_sweetness_styles);
            var carbonation = $.inArray(edit_style, req_carb_styles);
            var optional = $.inArray(edit_style, optional_info_styles);
            var pouring = $.inArray(edit_style, req_pouring);
            if (possible_allergens == null) {
                $("#possible-allergens").hide("fast");
                $("#possAllergens_0").prop("checked", false);
                $("#possAllergens_1").prop("checked", true)
            } else {
                $("#possible-allergens").show("fast");
                $("#possAllergens_0").prop("checked", true)
            }
            if (special_ing > -1) {
                disp_special_ing(edit_style, style_set);
                disp_req_modal(edit_style, style_set)
            }
            if (strength > -1) {
                disp_strength(edit_style, style_set);
                disp_req_modal(edit_style, style_set)
            }
            if (carbonation > -1) {
                disp_carbonation(edit_style, style_set);
                disp_req_modal(edit_style, style_set)
            }
            if (sweetness > -1) {
                disp_sweetness(edit_style, style_set);
                disp_req_modal(edit_style, style_set)
            }
            if (optional > -1) {
                disp_optional(edit_style, style_set);
                disp_req_modal(edit_style, style_set)
            }
            if (pouring > -1) {
                $("#specify-pouring").show("slow");
            }
            else {
                $("#specify-pouring").hide("slow");
            }
            require_visible()
        }

        $("#type").change(function () {
            if ($(this).val() == "00-00") {
                reset_element_states("default");
                $("#form-submit-button").prop("disabled", true);
            }
            else {
                $("#form-submit-button").prop("disabled", false);
                var style = $('#type').val();
                var special_ing = $.inArray(style, req_special_ing_styles);
                var strength = $.inArray(style, req_strength_styles);
                var sweetness = $.inArray(style, req_sweetness_styles);
                var carbonation = $.inArray(style, req_carb_styles);
                var optional = $.inArray(style, optional_info_styles);
                var pouring = $.inArray(style, req_pouring);
                reset_element_states("default");
                if (special_ing > -1) {
                    disp_special_ing(style, style_set);
                    disp_req_modal(style, style_set)
                }
                if (strength > -1) {
                    disp_strength(style, style_set);
                    disp_req_modal(style, style_set)
                }
                if (carbonation > -1) {
                    disp_carbonation(style, style_set);
                    disp_req_modal(style, style_set)
                }
                if (sweetness > -1) {
                    disp_sweetness(style, style_set);
                    disp_req_modal(style, style_set)
                }
                if (optional > -1) {
                    disp_optional(style, style_set)
                }
                if (pouring > -1) {
                    $("#specify-pouring").show("slow");
                }
                else {
                    $("#specify-pouring").hide("slow");
                }
                require_visible()
            }
                
        });

    }

    // ----------------------------------
    // Add/Edit User
    // ----------------------------------

    if ((section == "brewer") || (section == "admin") || (section == "step2")) {

        $("#brewerClubsOther").hide();
        $("#ahaProAmText").hide();
        $("#us-state").hide();
        $("#aus-state").hide();
        $("#ca-state").hide();
        $("#proAm").hide();
        $("#judge-waiver").hide();
        $("#bjcp-id").hide();
        $("#brewerJudgeFields").hide();
        $("#brewerStewardFields").hide();
        $("#brewerStaffFields").hide();
        $("#participant-orgs").hide();
        $("#security-question-change").hide();
        
        if ((action == "edit") && (brewer_country == "United States")) {
            $("#proAm").show();
            $("#ahaProAmText").show();
            $("#us-state").show();
            $("#aus-state").hide();
            $("#ca-state").hide();
            $("#non-us-state").hide()
        }
        
        if ((action == "edit") && (brewer_country == "Australia")) {
            $("#proAm").hide();
            $("#ahaProAmText").hide();
            $("#aus-state").show();
            $("#us-state").hide();
            $("#ca-state").hide();
            $("#non-us-state").hide()
        }
       
        if ((action == "edit") && (brewer_country == "Canada")) {
            $("#proAm").hide();
            $("#ahaProAmText").hide();
            $("#aus-state").hide();
            $("#us-state").hide();
            $("#ca-state").show();
            $("#non-us-state").hide()
        }
        
        $("#brewerCountry").change(function () {
                $("#brewerStateNon").val("");
                $("#brewerStateUS").val("");
                $("#brewerStateAUS").val("");
                $("#brewerStateCA").val("");
                $("#brewerStateUS option:selected").prop("selected", false);
                $("#brewerStateAUS option:selected").prop("selected", false);
                $("#brewerStateCA option:selected").prop("selected", false);
                $("#non-us-state").hide();
                $("#us-state").hide();
                $("#aus-state").hide();
                $("#ca-state").hide();
                $("#proAm").hide();
                $("#ahaProAmText").hide();
                if ($("#brewerCountry").val() == "United States") {
                    $("#proAm").show("slow");
                    $("#ahaProAmText").show("slow");
                    $("#us-state").show()
                } else if ($("#brewerCountry").val() == "Australia") {
                    $("#aus-state").show()
                } else if ($("#brewerCountry").val() == "Canada") {
                    $("#ca-state").show()
                } else {
                    $("#non-us-state").show();
                    $("#brewerProAm_0").prop("checked", true);
                    $("#brewerProAm_1").prop("checked", false)
                }
            });
        
        if ((action == "edit") && (club_other)) {
            $("#brewerClubsOther").show("slow");
            $("#clubOther").show("slow")
        }
        
        $("#brewerClubs")
            .change(function () {
                $("#brewerClubsOther").hide();
                $("#clubOther").hide();
                $("#clubOther-warning").hide();
                if ($("#brewerClubs").val() == "Other") {
                    $("#brewerClubsOther").show("slow");
                    $("#clubOther").show("slow")
                }
            });

        if ((action == "edit") && ((brewer_judge == "Y") || (brewer_steward == "Y"))) {
            $("#participant-orgs").show();
        }
        
        if ((action == "edit") && (brewer_judge == "Y")) {
            $("#brewerJudgeFields").show();
            $("#judge-steward-notes").show();
            $("#judge-waiver").show();
            $("#bjcp-id").show();
        }

        else {
            $("#brewerJudgeFields").hide();
            $("#judge-steward-notes").hide();
            $("#judge-waiver").hide();
            $("#bjcp-id").hide()
        }
        
        if ((action == "edit") && (brewer_steward == "Y")) {
            $("#brewerStewardFields").show();
            $("#judge-steward-notes").show();
            $("#judge-waiver").show();
            $("#bjcp-id").show()
        }
        
        else {
            $("#brewerStewardFields").hide();
            $("#judge-steward-notes").hide();
            if (brewer_judge == "N") {
                $("#judge-waiver").hide();
                $("#bjcp-id").hide()
            }
        }

        if ((action == "edit") && (brewer_staff == "Y")) {
            $("#brewerStaffFields").show();
            $("#judge-steward-notes").show()
        }

        $("#brewery-prod-label-icon").hide();

        $('input[type="radio"]').click(function () {

            if ($(this).attr('id') == 'brewerBreweryProd_0') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProdMeas']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProd_1') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProdMeas']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProd_2') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProdMeas']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProd_3') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProdMeas']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProd_4') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProdMeas']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProdMeas_0') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProd']").prop("required", true);       
            }

            if ($(this).attr('id') == 'brewerBreweryProdMeas_1') {
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label-icon").show();
                if ((action == "add") || (section == "register") || (!brewer_brewery_prod)) $("#brewery-prod-label").addClass("text-warning");
                $("input[name='brewerBreweryProd']").prop("required", true);       
            }
            
            if ($(this).attr('id') == 'brewerSteward_0') {
                $("#brewerStewardFields").show("slow");
                $("#participant-orgs").show("slow");
                $("#judge-steward-notes").show("slow");
                $("#judge-waiver").show("slow");
                $("#bjcp-id").show("slow");
            }

            if ($(this).attr('id') == 'brewerJudge_0') {
                $("#brewerJudgeFields").show("slow");
                $("#participant-orgs").show("slow");
                $("#judge-steward-notes").show("slow");
                $("#judge-waiver").show("slow");
                $("#bjcp-id").show("slow");
            }

            if ($(this).attr('id') == 'brewerSteward_1') {
                $("#brewerStewardFields").hide("slow");
                if ($('#brewerSteward_1').prop('checked')) {
                    $("#judge-waiver").hide("slow");
                    $("#bjcp-id").hide("slow");
                }
                if (($('#brewerStaff_1').prop('checked')) && ($('#brewerJudge_1').prop('checked'))) {
                    $("#judge-steward-notes").hide("slow")
                }
                if (($('#brewerSteward_1').prop('checked')) && ($('#brewerJudge_1').prop('checked'))) {
                    $("#participant-orgs").hide("slow");
                }
                if ($('#brewerJudge_0').prop('checked')) {
                    $("#participant-orgs").show();
                }
            }
            
            if ($(this).attr('id') == 'brewerJudge_1') {
                $("#brewerJudgeFields").hide("slow");
                if ($('#brewerJudge_1').prop('checked')) {
                    $("#judge-waiver").hide("slow");
                    $("#bjcp-id").hide("slow");
                }
                if (($('#brewerStaff_1').prop('checked')) && ($('#brewerSteward_1').prop('checked'))) {
                    $("#judge-steward-notes").hide("slow")
                }
                if (($('#brewerSteward_1').prop('checked')) && ($('#brewerJudge_1').prop('checked'))) {
                    $("#participant-orgs").hide("slow");
                }
                if ($('#brewerSteward_0').prop('checked')) {
                    $("#participant-orgs").show();
                }
            }

            if ($(this).attr('id') == 'brewerStaff_0') {
                $("#brewerStaffFields").show("slow");
                $("#judge-steward-notes").show("slow");
                $("#staff-help").show("slow")
            }

            if ($(this).attr('id') == 'brewerStaff_1') {
                $("#brewerStaffFields").hide("slow");
                if (($('#brewerJudge_1').prop('checked')) && ($('#brewerSteward_1').prop('checked'))) {
                    $("#judge-steward-notes").hide("slow");
                    $("#staff-help").hide("slow")
                }
            }

            if ($(this).attr('id') == 'change-security-0') {
                $("#security-question-change").hide("slow");
                $("input[name='userQuestionAnswer']").prop("required", false);
                $("#userQuestionAnswer").val(user_question_answer)
            }

            if ($(this).attr('id') == 'change-security-1') {
                $("#security-question-change").show("slow");
                $("input[name='userQuestionAnswer']").prop("required", true);
                $("#userQuestionAnswer").val('')
            }

        });

    }

}); // End Document Ready