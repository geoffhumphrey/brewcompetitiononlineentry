$(document).ready(function () {
        
        // Invoke TomSelect for some select form elements
        document.querySelectorAll('.bootstrap-select').forEach((el) => {
            let settings = {
                maxOptions: 1000,
                allowEmptyOption: false
            };
            new TomSelect(el, settings);
        });
        
        // Enable BS Tooltips
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
        
        // Enable BS Popovers
        var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
        
        var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
            return new bootstrap.Popover(popoverTriggerEl)
        });

        var topoffset = 55;
        
        // Single Page Nav Elements
        $('.navbar a[href*=\\#]:not([href=\\#])').click(function () {
            
            if (location.pathname.replace(/^\//, '') === this.pathname.replace(/^\//, '') && location.hostname === this.hostname) {
                
                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top - topoffset + 2
                    }, 500);
                    return false;
                }
            }
        
        });

        $('.modal-body a[href*=\\#]:not([href=\\#])').click(function () {
            
            if (location.pathname.replace(/^\//, '') === this.pathname.replace(/^\//, '') && location.hostname === this.hostname) {
                
                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                
                if (target.length) {
                    $('.modal').modal('hide');
                    $('html,body').animate({
                        scrollTop: target.offset().top - topoffset + 2
                    }, 500);
                    return false;
                }

            }
        });

        $('.contains-link a[href*=\\#]:not([href=\\#])').click(function () {
            
            if (location.pathname.replace(/^\//, '') === this.pathname.replace(/^\//, '') && location.hostname === this.hostname) {
                
                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top - topoffset + 2
                    }, 500);
                    return false;
                }

            }
        
        });

        if (section == "default") {

            // Show Scroll to Top button on ScrollSpy
            // Only for home page
            $(window).on('activate.bs.scrollspy', function () {
                
                var hash = $('.site-nav').find('a.active').attr('href');

                if (hash === '#home') {
                    $('#sticky-home').slideUp(500);
                } else {
                    $('#sticky-home').slideDown(500);
                }
            
            });

        } else {

            // Other pages, show/hide Scroll to Top button
            $(window).scroll(function () {
                if ($(this).scrollTop() > 400) {
                    $('#sticky-home').slideDown(500);
                } else {
                    $('#sticky-home').slideUp(500);
                }
            });

            $('#sticky-home').click(function () {
                $('html, body').animate({ 
                    scrollTop: target.offset().top - topoffset + 2
                }, 500);
            });

        }

        const animateCSS = (element, animation, prefix = 'animate__') => new Promise((resolve, reject) => {
            const animationName = `${prefix}${animation}`;
            const node = document.querySelector(element);
            node
                .classList
                .add(`${prefix}animated`, animationName);
                
            function handleAnimationEnd(event) {
                event.stopPropagation();
                node
                    .classList
                    .remove(`${prefix}animated`, animationName);
                    resolve('Animation ended')
                }
            
            node.addEventListener('animationend', handleAnimationEnd, {once: true})
        
        });

    });

    // Form Validation
    (() => {
        
        'use strict';
        const forms = document.querySelectorAll('.needs-validation');
        
        Array.from(forms).forEach(form => {
            
            form.addEventListener('submit', event => {
                
                if (!form.checkValidity()) {
                    
                    document.getElementById('loader-submit').style.display = 'none';
                    event.preventDefault();
                    event.stopPropagation();
                    $("#form-submit-button-disabled-msg-required").modal('show');
                
                } else {
                    document.getElementById('loader-submit').style.display = 'block';
                }

                form.classList.add('was-validated');

            }, false)
        });
    
    })();